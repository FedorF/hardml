# Многорукие бандиты

Базовый класс `strategies.Strategy` содержит следующие атрибуты:
`n_arms` - количество ручек для "дерганья" <br>
`n_iters` - количество доступных итераций <br>
`arms_states` - пространство состояний ручек <br> 
`arms_actions` - пространство действий для ручек <br>

Методы базового класса:
`flush()` - для обновления стратегии <br>
`update_reward()` - функция для обновления стратегии, где учитываются действия и получаемые награды <br>
`choose_arm()` - для непосредственно выбора "ручки бандита" <br>

Epsilon-жадная стратегия `strategies.EpsGreedy`, в основе которой лежит простой принцип - всегда выбираем "ручку", 
которая дает наибольшую награду. Имеет параметр: `eps` - вероятность выбора не лучшей "ручки", 
а случайной для исследования среды. 
Можно в принципе уменьшать эту вероятность со временем `epsilon_decreasing`. <br>

Стратегия `strategies.UCB1` - оптимизация с использованием знаний о неопределенности. Строится оптимистическое 
предположение о том, насколько хорош желаемый результат для каждого действия. 
Дальше выбирается действие с наибольшим предполагаемым выигрышем. 
Если же наше предположение оказалось неверным, то наша оценка уменьшается, и мы переключаемся на другое действие. 
Но если же выбор был сделан верным, то наше значение величины `regret` будет мало. 
Таким образом мы уравновешиваем одновременно изучение бандитов и их эксплуатацию.
Основным вопрос является как раз задание этого оптимистичного прогноза - верхней доверительной гранциы (UCB). 
Для решения этой задачи на помощь приходит [неравенство Чернова-Хёфдинга][4]. <br>
Алгоритм семплирования Томпсона `strategies.Thompson` на основе [бета распределения][6] и [байесовского подхода][5].
Подробнее можно почитать в [статье][1].


### Дополнительные материалы

[Статья][1] про задачу о многоруком бандите <br>
Библиотеки с реализациями бандитов: [contextualbandits][2], [space-bandits][3] 




[1]: https://habr.com/ru/post/425619/
[2]: https://github.com/david-cortes/contextualbandits
[3]: https://github.com/LaunchpadAI/space-bandits
[4]: https://ru.wikipedia.org/wiki/Граница_Чернова#Теорема_Чернова-Хёфдинга_(аддитивная_форма)
[5]: https://dyakonov.org/2018/07/30/%D0%B1%D0%B0%D0%B9%D0%B5%D1%81%D0%BE%D0%B2%D1%81%D0%BA%D0%B8%D0%B9-%D0%BF%D0%BE%D0%B4%D1%85%D0%BE%D0%B4/
[6]: https://ru.wikipedia.org/wiki/%D0%91%D0%B5%D1%82%D0%B0-%D1%80%D0%B0%D1%81%D0%BF%D1%80%D0%B5%D0%B4%D0%B5%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5
